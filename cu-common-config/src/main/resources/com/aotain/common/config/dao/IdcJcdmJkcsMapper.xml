<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.aotain.common.config.dao.IdcJcdmJkcsMapper">
  <resultMap id="BaseResultMap" type="com.aotain.common.config.model.IdcJcdmJkcs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="ID" jdbcType="DECIMAL" property="id" />
    <result column="CS_KEY" jdbcType="VARCHAR" property="csKey" />
    <result column="CS_VALUE" jdbcType="VARCHAR" property="csValue" />
    <result column="CS_DESCRIBE" jdbcType="VARCHAR" property="csDescribe" />
    <result column="SRLX" jdbcType="DECIMAL" property="srlx" />
    <result column="TYPE" jdbcType="VARCHAR" property="type" />
    <result column="SFYX" jdbcType="DECIMAL" property="sfyx" />
    <result column="MODEL_TYPE" jdbcType="DECIMAL" property="modelType" />
    <result column="IS_PASSWORD" jdbcType="DECIMAL" property="isPassword" />
  </resultMap>
  <resultMap id="SystemConfigMap" type="com.aotain.common.config.model.Isms3rdSystemConfig">
    <result column="ID" jdbcType="DECIMAL" property="id" />
    <result column="SYS_NAME" jdbcType="VARCHAR" property="sysName" />
    <result column="SYS_IDENTIFIER" jdbcType="VARCHAR" property="sysIdentifier" />
    <result column="ACK_REPLY_URL" jdbcType="VARCHAR" property="ackReplyUrl" />
    <result column="USER_PWD" jdbcType="DECIMAL" property="userPwd" />
    <result column="AES_KEY" jdbcType="VARCHAR" property="aesKey" />
    <result column="AES_IV" jdbcType="DECIMAL" property="aesIv" />
    <result column="MESSAGE_PWD" jdbcType="DECIMAL" property="messagePwd" />
    <result column="VERSION" jdbcType="DECIMAL" property="version" />
    <result column="SERVICE_SWITCH" jdbcType="DECIMAL" property="serviceSwitch" />
    <result column="CREATE_TIME" jdbcType="DECIMAL" property="createTime" />
    <result column="MODIFY_TIME" jdbcType="DECIMAL" property="modifyTime" />
    <result column="DEL_FLAG" jdbcType="DECIMAL" property="delFlag" />
  </resultMap>	

  <select id="selectIdcHouses"  resultType="com.aotain.common.config.model.IdcHouses">
    select 
		idc.idcid IdcId,
		house.houseid HouseId,
		house.houseidstr HouseIdStr,
		house.clusterid ClusterId,
		house.identify Identity,
		house.czlx isReport
	from (select * from idc_isms_base_house t1 where t1.del_flag != 1) house
	join (select * from idc_isms_base_idc t2 where t2.del_flag != 1) idc on house.jyzid = idc.jyzid
  </select>
  
  <select id="selectClusterHouses"  resultType="com.aotain.common.config.model.ClusterHouses">
  	select 
		a.CLUSTERID clusterId,
		a.USERNAME userName,
		a.PASSWORD password,
		a.HIVE_DRIVER hiveDriver,
		a.HIVE_URL hiveUrl,
		a.IMPALA_DRIVER impalaDriver,
		a.IMPALA_URL impalaUrl,
		a.REDIS_INFO redisInfo,
		a.namenode_info namenodeInfo,
		a.azkaban_url azkabanUrl,
		a.zookeeper_connect zookeeperConnect,
		a.kafka_broker_list kafkaBrokerList,
		a.kafka_path kafkaPath,
		a.ud_customer_thread_num udCustomerThreadNum,
		b.HOUSEID hosueId
	from IDC_JCDM_JQPZ a 
	join IDC_ISMS_BASE_HOUSE b ON a.CLUSTERID = b.CLUSTERID
	join IDC_ISMS_BASE_IDC c on c.idcname = a.idcname
  </select>
  
  <select id="selectConfig"  resultType="com.aotain.common.config.model.IdcJcdmJkcs">
    select id,CS_KEY AS csKey,CS_VALUE AS csValue,TYPE from IDC_JCDM_JKCS t
    where t.sfyx = 1
  </select>

  <insert id="insert" parameterType="com.aotain.common.config.model.IdcJcdmJkcs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into IDC_JCDM_JKCS (ID, CS_KEY, CS_VALUE,
      CS_DESCRIBE, SRLX, TYPE, 
      SFYX, MODEL_TYPE, IS_PASSWORD
      )
    values (#{id,jdbcType=DECIMAL}, #{csKey,jdbcType=VARCHAR}, #{csValue,jdbcType=VARCHAR}, 
      #{csDescribe,jdbcType=VARCHAR}, #{srlx,jdbcType=DECIMAL}, #{type,jdbcType=VARCHAR}, 
      #{sfyx,jdbcType=DECIMAL}, #{modelType,jdbcType=DECIMAL}, #{isPassword,jdbcType=DECIMAL}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.aotain.common.config.model.IdcJcdmJkcs">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into IDC_JCDM_JKCS
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="csKey != null">
        CS_KEY,
      </if>
      <if test="csValue != null">
        CS_VALUE,
      </if>
      <if test="csDescribe != null">
        CS_DESCRIBE,
      </if>
      <if test="srlx != null">
        SRLX,
      </if>
      <if test="type != null">
        TYPE,
      </if>
      <if test="sfyx != null">
        SFYX,
      </if>
      <if test="modelType != null">
        MODEL_TYPE,
      </if>
      <if test="isPassword != null">
        IS_PASSWORD,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=DECIMAL},
      </if>
      <if test="csKey != null">
        #{csKey,jdbcType=VARCHAR},
      </if>
      <if test="csValue != null">
        #{csValue,jdbcType=VARCHAR},
      </if>
      <if test="csDescribe != null">
        #{csDescribe,jdbcType=VARCHAR},
      </if>
      <if test="srlx != null">
        #{srlx,jdbcType=DECIMAL},
      </if>
      <if test="type != null">
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="sfyx != null">
        #{sfyx,jdbcType=DECIMAL},
      </if>
      <if test="modelType != null">
        #{modelType,jdbcType=DECIMAL},
      </if>
      <if test="isPassword != null">
        #{isPassword,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  
  <select id="selectIsms3rdSystemConfigInfoByIdentify" parameterType="String" resultMap="SystemConfigMap">
  	select * from idc_isms_3rd_system_config t where t.sys_identifier = #{systemIdentifier} and del_flag=0
  </select>
</mapper>